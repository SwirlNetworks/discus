!function(e){if("object"==typeof exports)module.exports=e();else if("function"==typeof define&&define.amd)define(e);else{var t;"undefined"!=typeof window?t=window:"undefined"!=typeof global?t=global:"undefined"!=typeof self&&(t=self),t.Discus=e()}}(function(){var e;return function t(e,i,n){function s(o,a){if(!i[o]){if(!e[o]){var l="function"==typeof require&&require;if(!a&&l)return l(o,!0);if(r)return r(o,!0);throw new Error("Cannot find module '"+o+"'")}var c=i[o]={exports:{}};e[o][0].call(c.exports,function(t){var i=e[o][1][t];return s(i?i:t)},c,c.exports,t,e,i,n)}return i[o].exports}for(var r="function"==typeof require&&require,o=0;o<n.length;o++)s(n[o]);return s}({1:[function(t,i,n){(function(t){!function(){function n(e){var t=!1;return function(){if(t)throw new Error("Callback was already called.");t=!0,e.apply(s,arguments)}}var s,r,o={};s=this,null!=s&&(r=s.async),o.noConflict=function(){return s.async=r,o};var a=Object.prototype.toString,l=Array.isArray||function(e){return"[object Array]"===a.call(e)},c=function(e,t){for(var i=0;i<e.length;i+=1)t(e[i],i,e)},h=function(e,t){if(e.map)return e.map(t);var i=[];return c(e,function(e,n,s){i.push(t(e,n,s))}),i},d=function(e,t,i){return e.reduce?e.reduce(t,i):(c(e,function(e,n,s){i=t(i,e,n,s)}),i)},u=function(e){if(Object.keys)return Object.keys(e);var t=[];for(var i in e)e.hasOwnProperty(i)&&t.push(i);return t};"undefined"!=typeof t&&t.nextTick?(o.nextTick=t.nextTick,"undefined"!=typeof setImmediate?o.setImmediate=function(e){setImmediate(e)}:o.setImmediate=o.nextTick):"function"==typeof setImmediate?(o.nextTick=function(e){setImmediate(e)},o.setImmediate=o.nextTick):(o.nextTick=function(e){setTimeout(e,0)},o.setImmediate=o.nextTick),o.each=function(e,t,i){function s(t){t?(i(t),i=function(){}):(r+=1,r>=e.length&&i())}if(i=i||function(){},!e.length)return i();var r=0;c(e,function(e){t(e,n(s))})},o.forEach=o.each,o.eachSeries=function(e,t,i){if(i=i||function(){},!e.length)return i();var n=0,s=function(){t(e[n],function(t){t?(i(t),i=function(){}):(n+=1,n>=e.length?i():s())})};s()},o.forEachSeries=o.eachSeries,o.eachLimit=function(e,t,i,n){var s=p(t);s.apply(null,[e,i,n])},o.forEachLimit=o.eachLimit;var p=function(e){return function(t,i,n){if(n=n||function(){},!t.length||0>=e)return n();var s=0,r=0,o=0;!function a(){if(s>=t.length)return n();for(;e>o&&r<t.length;)r+=1,o+=1,i(t[r-1],function(e){e?(n(e),n=function(){}):(s+=1,o-=1,s>=t.length?n():a())})}()}},f=function(e){return function(){var t=Array.prototype.slice.call(arguments);return e.apply(null,[o.each].concat(t))}},m=function(e,t){return function(){var i=Array.prototype.slice.call(arguments);return t.apply(null,[p(e)].concat(i))}},g=function(e){return function(){var t=Array.prototype.slice.call(arguments);return e.apply(null,[o.eachSeries].concat(t))}},v=function(e,t,i,n){if(t=h(t,function(e,t){return{index:t,value:e}}),n){var s=[];e(t,function(e,t){i(e.value,function(i,n){s[e.index]=n,t(i)})},function(e){n(e,s)})}else e(t,function(e,t){i(e.value,function(e){t(e)})})};o.map=f(v),o.mapSeries=g(v),o.mapLimit=function(e,t,i,n){return y(t)(e,i,n)};var y=function(e){return m(e,v)};o.reduce=function(e,t,i,n){o.eachSeries(e,function(e,n){i(t,e,function(e,i){t=i,n(e)})},function(e){n(e,t)})},o.inject=o.reduce,o.foldl=o.reduce,o.reduceRight=function(e,t,i,n){var s=h(e,function(e){return e}).reverse();o.reduce(s,t,i,n)},o.foldr=o.reduceRight;var _=function(e,t,i,n){var s=[];t=h(t,function(e,t){return{index:t,value:e}}),e(t,function(e,t){i(e.value,function(i){i&&s.push(e),t()})},function(e){n(h(s.sort(function(e,t){return e.index-t.index}),function(e){return e.value}))})};o.filter=f(_),o.filterSeries=g(_),o.select=o.filter,o.selectSeries=o.filterSeries;var w=function(e,t,i,n){var s=[];t=h(t,function(e,t){return{index:t,value:e}}),e(t,function(e,t){i(e.value,function(i){i||s.push(e),t()})},function(e){n(h(s.sort(function(e,t){return e.index-t.index}),function(e){return e.value}))})};o.reject=f(w),o.rejectSeries=g(w);var S=function(e,t,i,n){e(t,function(e,t){i(e,function(i){i?(n(e),n=function(){}):t()})},function(e){n()})};o.detect=f(S),o.detectSeries=g(S),o.some=function(e,t,i){o.each(e,function(e,n){t(e,function(e){e&&(i(!0),i=function(){}),n()})},function(e){i(!1)})},o.any=o.some,o.every=function(e,t,i){o.each(e,function(e,n){t(e,function(e){e||(i(!1),i=function(){}),n()})},function(e){i(!0)})},o.all=o.every,o.sortBy=function(e,t,i){o.map(e,function(e,i){t(e,function(t,n){t?i(t):i(null,{value:e,criteria:n})})},function(e,t){if(e)return i(e);var n=function(e,t){var i=e.criteria,n=t.criteria;return n>i?-1:i>n?1:0};i(null,h(t.sort(n),function(e){return e.value}))})},o.auto=function(e,t){t=t||function(){};var i=u(e),n=i.length;if(!n)return t();var s={},r=[],a=function(e){r.unshift(e)},h=function(e){for(var t=0;t<r.length;t+=1)if(r[t]===e)return void r.splice(t,1)},p=function(){n--,c(r.slice(0),function(e){e()})};a(function(){if(!n){var e=t;t=function(){},e(null,s)}}),c(i,function(i){var n=l(e[i])?e[i]:[e[i]],r=function(e){var n=Array.prototype.slice.call(arguments,1);if(n.length<=1&&(n=n[0]),e){var r={};c(u(s),function(e){r[e]=s[e]}),r[i]=n,t(e,r),t=function(){}}else s[i]=n,o.setImmediate(p)},f=n.slice(0,Math.abs(n.length-1))||[],m=function(){return d(f,function(e,t){return e&&s.hasOwnProperty(t)},!0)&&!s.hasOwnProperty(i)};if(m())n[n.length-1](r,s);else{var g=function(){m()&&(h(g),n[n.length-1](r,s))};a(g)}})},o.retry=function(e,t,i){var n=5,s=[];"function"==typeof e&&(i=t,t=e,e=n),e=parseInt(e,10)||n;var r=function(n,r){for(var a=function(e,t){return function(i){e(function(e,n){i(!e||t,{err:e,result:n})},r)}};e;)s.push(a(t,!(e-=1)));o.series(s,function(e,t){t=t[t.length-1],(n||i)(t.err,t.result)})};return i?r():r},o.waterfall=function(e,t){if(t=t||function(){},!l(e)){var i=new Error("First argument to waterfall must be an array of functions");return t(i)}if(!e.length)return t();var n=function(e){return function(i){if(i)t.apply(null,arguments),t=function(){};else{var s=Array.prototype.slice.call(arguments,1),r=e.next();r?s.push(n(r)):s.push(t),o.setImmediate(function(){e.apply(null,s)})}}};n(o.iterator(e))()};var C=function(e,t,i){if(i=i||function(){},l(t))e.map(t,function(e,t){e&&e(function(e){var i=Array.prototype.slice.call(arguments,1);i.length<=1&&(i=i[0]),t.call(null,e,i)})},i);else{var n={};e.each(u(t),function(e,i){t[e](function(t){var s=Array.prototype.slice.call(arguments,1);s.length<=1&&(s=s[0]),n[e]=s,i(t)})},function(e){i(e,n)})}};o.parallel=function(e,t){C({map:o.map,each:o.each},e,t)},o.parallelLimit=function(e,t,i){C({map:y(t),each:p(t)},e,i)},o.series=function(e,t){if(t=t||function(){},l(e))o.mapSeries(e,function(e,t){e&&e(function(e){var i=Array.prototype.slice.call(arguments,1);i.length<=1&&(i=i[0]),t.call(null,e,i)})},t);else{var i={};o.eachSeries(u(e),function(t,n){e[t](function(e){var s=Array.prototype.slice.call(arguments,1);s.length<=1&&(s=s[0]),i[t]=s,n(e)})},function(e){t(e,i)})}},o.iterator=function(e){var t=function(i){var n=function(){return e.length&&e[i].apply(null,arguments),n.next()};return n.next=function(){return i<e.length-1?t(i+1):null},n};return t(0)},o.apply=function(e){var t=Array.prototype.slice.call(arguments,1);return function(){return e.apply(null,t.concat(Array.prototype.slice.call(arguments)))}};var b=function(e,t,i,n){var s=[];e(t,function(e,t){i(e,function(e,i){s=s.concat(i||[]),t(e)})},function(e){n(e,s)})};o.concat=f(b),o.concatSeries=g(b),o.whilst=function(e,t,i){e()?t(function(n){return n?i(n):void o.whilst(e,t,i)}):i()},o.doWhilst=function(e,t,i){e(function(n){if(n)return i(n);var s=Array.prototype.slice.call(arguments,1);t.apply(null,s)?o.doWhilst(e,t,i):i()})},o.until=function(e,t,i){e()?i():t(function(n){return n?i(n):void o.until(e,t,i)})},o.doUntil=function(e,t,i){e(function(n){if(n)return i(n);var s=Array.prototype.slice.call(arguments,1);t.apply(null,s)?i():o.doUntil(e,t,i)})},o.queue=function(e,t){function i(e,t,i,n){return e.started||(e.started=!0),l(t)||(t=[t]),0==t.length?o.setImmediate(function(){e.drain&&e.drain()}):void c(t,function(t){var s={data:t,callback:"function"==typeof n?n:null};i?e.tasks.unshift(s):e.tasks.push(s),e.saturated&&e.tasks.length===e.concurrency&&e.saturated(),o.setImmediate(e.process)})}void 0===t&&(t=1);var s=0,r={tasks:[],concurrency:t,saturated:null,empty:null,drain:null,started:!1,paused:!1,push:function(e,t){i(r,e,!1,t)},kill:function(){r.drain=null,r.tasks=[]},unshift:function(e,t){i(r,e,!0,t)},process:function(){if(!r.paused&&s<r.concurrency&&r.tasks.length){var t=r.tasks.shift();r.empty&&0===r.tasks.length&&r.empty(),s+=1;var i=function(){s-=1,t.callback&&t.callback.apply(t,arguments),r.drain&&r.tasks.length+s===0&&r.drain(),r.process()},o=n(i);e(t.data,o)}},length:function(){return r.tasks.length},running:function(){return s},idle:function(){return r.tasks.length+s===0},pause:function(){r.paused!==!0&&(r.paused=!0)},resume:function(){if(r.paused!==!1){r.paused=!1;for(var e=1;e<=r.concurrency;e++)o.setImmediate(r.process)}}};return r},o.priorityQueue=function(e,t){function i(e,t){return e.priority-t.priority}function n(e,t,i){for(var n=-1,s=e.length-1;s>n;){var r=n+(s-n+1>>>1);i(t,e[r])>=0?n=r:s=r-1}return n}function s(e,t,s,r){return e.started||(e.started=!0),l(t)||(t=[t]),0==t.length?o.setImmediate(function(){e.drain&&e.drain()}):void c(t,function(t){var a={data:t,priority:s,callback:"function"==typeof r?r:null};e.tasks.splice(n(e.tasks,a,i)+1,0,a),e.saturated&&e.tasks.length===e.concurrency&&e.saturated(),o.setImmediate(e.process)})}var r=o.queue(e,t);return r.push=function(e,t,i){s(r,e,t,i)},delete r.unshift,r},o.cargo=function(e,t){var i=!1,n=[],s={tasks:n,payload:t,saturated:null,empty:null,drain:null,drained:!0,push:function(e,i){l(e)||(e=[e]),c(e,function(e){n.push({data:e,callback:"function"==typeof i?i:null}),s.drained=!1,s.saturated&&n.length===t&&s.saturated()}),o.setImmediate(s.process)},process:function r(){if(!i){if(0===n.length)return s.drain&&!s.drained&&s.drain(),void(s.drained=!0);var o="number"==typeof t?n.splice(0,t):n.splice(0,n.length),a=h(o,function(e){return e.data});s.empty&&s.empty(),i=!0,e(a,function(){i=!1;var e=arguments;c(o,function(t){t.callback&&t.callback.apply(null,e)}),r()})}},length:function(){return n.length},running:function(){return i}};return s};var T=function(e){return function(t){var i=Array.prototype.slice.call(arguments,1);t.apply(null,i.concat([function(t){var i=Array.prototype.slice.call(arguments,1);"undefined"!=typeof console&&(t?console.error&&console.error(t):console[e]&&c(i,function(t){console[e](t)}))}]))}};o.log=T("log"),o.dir=T("dir"),o.memoize=function(e,t){var i={},n={};t=t||function(e){return e};var s=function(){var s=Array.prototype.slice.call(arguments),r=s.pop(),a=t.apply(null,s);a in i?o.nextTick(function(){r.apply(null,i[a])}):a in n?n[a].push(r):(n[a]=[r],e.apply(null,s.concat([function(){i[a]=arguments;var e=n[a];delete n[a];for(var t=0,s=e.length;s>t;t++)e[t].apply(null,arguments)}])))};return s.memo=i,s.unmemoized=e,s},o.unmemoize=function(e){return function(){return(e.unmemoized||e).apply(null,arguments)}},o.times=function(e,t,i){for(var n=[],s=0;e>s;s++)n.push(s);return o.map(n,t,i)},o.timesSeries=function(e,t,i){for(var n=[],s=0;e>s;s++)n.push(s);return o.mapSeries(n,t,i)},o.seq=function(){var e=arguments;return function(){var t=this,i=Array.prototype.slice.call(arguments),n=i.pop();o.reduce(e,i,function(e,i,n){i.apply(t,e.concat([function(){var e=arguments[0],t=Array.prototype.slice.call(arguments,1);n(e,t)}]))},function(e,i){n.apply(t,[e].concat(i))})}},o.compose=function(){return o.seq.apply(null,Array.prototype.reverse.call(arguments))};var M=function(e,t){var i=function(){var i=this,n=Array.prototype.slice.call(arguments),s=n.pop();return e(t,function(e,t){e.apply(i,n.concat([t]))},s)};if(arguments.length>2){var n=Array.prototype.slice.call(arguments,2);return i.apply(this,n)}return i};o.applyEach=f(M),o.applyEachSeries=g(M),o.forever=function(e,t){function i(n){if(n){if(t)return t(n);throw n}e(i)}i()},"undefined"!=typeof i&&i.exports?i.exports=o:"undefined"!=typeof e&&e.amd?e([],function(){return o}):s.async=o}()}).call(this,t("1YiZ5S"))},{"1YiZ5S":2}],2:[function(e,t,i){function n(){}var s=t.exports={};s.nextTick=function(){var e="undefined"!=typeof window&&window.setImmediate,t="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(e)return function(e){return window.setImmediate(e)};if(t){var i=[];return window.addEventListener("message",function(e){var t=e.source;if((t===window||null===t)&&"process-tick"===e.data&&(e.stopPropagation(),i.length>0)){var n=i.shift();n()}},!0),function(e){i.push(e),window.postMessage("process-tick","*")}}return function(e){setTimeout(e,0)}}(),s.title="browser",s.browser=!0,s.env={},s.argv=[],s.on=n,s.addListener=n,s.once=n,s.off=n,s.removeListener=n,s.removeAllListeners=n,s.emit=n,s.binding=function(e){throw new Error("process.binding is not supported")},s.cwd=function(){return"/"},s.chdir=function(e){throw new Error("process.chdir is not supported")}},{}],3:[function(e,t,i){var n=e("./discus");e("./model");var s=e("./super"),r=e("backbone");n.Collection=function(){r.Collection.apply(this,arguments),this.discusInitialize.apply(this,arguments)},n.Collection.prototype=r.Collection.prototype,n.Collection.extend=r.Collection.extend,n.Collection=n.Collection.extend({_super:s,model:n.Model,discusInitialize:function(){}}),t.exports=n.Collection},{"./discus":4,"./model":7,"./super":10,backbone:"205lIr"}],4:[function(e,t,i){function n(){function e(){}var t,i=this,o=i.sync;return e.prototype=i,e.prototype.createClone=n,t=new e,t.VERSION_ARRAY=r(s.VERSION.split(".")).map(function(e){return parseInt(e)}),i.sync=function(){return t.hasOwnProperty("sync")?t.sync.apply(t,arguments):o.apply(i,arguments)},t}var s=e("backbone"),r=e("underscore");t.exports=n.apply(s)},{backbone:"205lIr",underscore:"h15NQi"}],5:[function(e,t,i){function n(e){return e.scrollHeight>e.clientHeight}function s(e){for(;e&&!n(e);){if(e===e.parentNode)return null;e=e.parentNode}return e}function r(e){return function(){return this.isRemoved?void console.warn("ran on a removed list view"):e.apply(this,arguments)}}var o=e("./discus"),a=e("async"),l=e("underscore"),c=e("jquery");e("./view"),e("./model"),o.ListView=o.View.extend({className:"listView",tagName:"ul",events:{},defaults:function(){var e={viewClass:this.viewClass||null,viewClassOptions:{},showLoadingAnimation:!1,loadingPromise:(new c.Deferred).resolve(),multiSelect:!1,emptyImageType:"",renderOffscreen:3,scrollLoad:!0,searchEnabled:!1,searchInputSelector:"",contextMenu:null,showEmptyTableText:!1,emptyTableText:null,delayEmptyTableText:!0,hideIfEmpty:!1,initialSelection:null,dragOrderingEnabled:!1,readOnlyDrag:!1,dragOrderingSelector:"",renderLimit:8,renderThrottle:250,renderAttached:!1,sparse:!1,sparseLimit:20,sparseTagName:"div",sharedView:this.options.shareView};return e},initialize:function(){var e=this;if(this.sparse={offset:0},l.defaults(this.options,this.defaults()),this._d={resetCollection:!1,modelChanges:{},viewCache:{},listCache:[],renderedViews:[]},this.options.sync||(this.updateViews=l.debounce(this.updateViews),this.renderModels=l.debounce(this.renderModels),this.selectedChanged=l.debounce(this.selectedChanged),this.handleScroll=l.debounce(this.handleScroll,10),this.render=l.debounce(this.render)),l.bindAll(this,"refilter","resort","resetCollection","renderModels"),this.stateModel=this.createSharedStateModel("listView"),!this.options.viewClass)throw new Error("Must specify a viewClass name before initialization when using ListView "+this.options.viewClass);this.options.shareView&&console.error("please use sharedView, shareView was a dumb name."),this.options.childData&&(console.warn("Use viewClassOptions instead of childData"),this.options.viewClassOptions=c.extend({},this.options.childData,this.options.viewClassOptions)),this.loadingPromise=this.options.loadingPromise,this.collection.promise&&(this.loadingPromise=c.when(this.collection.promise(),this.loadingPromise)),"resolved"!==this.loadingPromise.state()&&this.loadingPromise.done(function(){e._resetCollection()}),this.listenTo(this.collection,"fetch",function(e){var t=this;t.addLoadingPromise(e),0===this.collection.length&&this._resetCollection()}),this.listenTo(this.collection,"add",this._addModel),this.listenTo(this.collection,"remove",this._removeModel),this.listenTo(this.collection,"reset",this._resetCollection),this.listenTo(this.collection,"loading_promise",this.addLoadingPromise),this.options.onChange&&this.listenTo(this.collection,"change",this.modelChange),this.options.searchEnabled&&c(document).on("finishedtyping."+this.cid,this.options.searchInputSelector,this.refilter),void 0!==this.options.multiSelect&&this.options.initialSelection&&(this.initialSelection=this.options.initialSelection,l.isArray(this.initialSelection)||(this.initialSelection=[this.initialSelection]),this.initialSelection=l(this.initialSelection).map(function(e){return e.model?e.model.get("id"):e.id||e})),this.collection.length&&l.delay(this.resetCollection,this)},onViewsChanged:function(){},render:function(){this._super("render",arguments),this.$el.parent().length&&this.rebuildDOM()},rebuildDOM:function(){this.options.sparse&&(this.sparse.scrollParent&&this.sparse.scrollParent.length||this.generateSparseRenderTarget());var e=this.getRenderTarget();return this.detachDOM(),e.empty(),this.$el.empty(),this.options.hideIfEmpty&&!this._d.renderedViews.length?void this.attachDOM():(this.renderHeader(),this.sparse.holder&&(this.sparse.holder.appendTo(this.$el),this.sparse.holder.attr("class","list_view_slider "+this.options.sparseClassName)),this.isLoading()?(this._d.loadingSpinnerShown=!0,this.renderLoading()):0===this._d.listCache.length?this.showNoData():(l(this._d.renderedViews).each(function(t){t.renderTo(e)}),this.renderFooter()),void this.attachDOM())},resetCollection:r(function(){this._d.resetCollection=!0,this.updateViews()}),addModel:function(e){var t=this._d;return t.hasData?(t.modelChanges[e.cid]={t:"add",m:e},void this.updateViews()):this.resetCollection()},removeModel:function(e){this._d.modelChanges[e.cid]={t:"remove",m:e},this.updateViews()},modelChange:function(e){this.getView(e).render()},updateViews:r(function(){var e=this,t=this._d;return t.resetCollection?void this._resetCollection():(this.detachDOM(),c.each(t.modelChanges,function(i,n){delete t.modelChanges[i],e["_"+n.t+"Model"](n.m)}),this.renderModels(),void this.attachDOM())}),_detachCount:0,attachDOM:function(){this.options.renderAttached||(this._detachCount--,this._detachCount>0||(this.placeHolder&&this.placeHolder.parent().length&&this.$el.insertAfter(this.placeHolder),this.placeHolder.remove(),this.placeHolder=null,this.redelegateEvents()))},detachDOM:function(){if(!this.options.renderAttached){if(this._detachCount>0)return void this._detachCount++;this.placeHolder=c("<div />",{css:{height:this.$el.height(),width:this.$el.width(),position:this.$el.css("position"),top:this.$el.css("top"),left:this.$el.css("left")}}).insertAfter(this.$el),this.$el.detach(),this._detachCount++}},_resetCollection:r(function(){var e,t=this,i=this._d;i.hasData=!1,i.modelChanges={},i.resetCollection=!1,console.log("Resetting the entire list view state!!!"),this.getRenderTarget().empty(),i.renderedViews=[],this.changed(),e=this.collection.models.concat(),e=l(e).filter(function(e){return t.filterModel(e)}),t.sortBy&&(e=l(e).sortBy(t.sortBy,t),t.sortBy.reverse&&e.reverse()),i.listCache=l(e).map(function(e){return{s:t.sortBy?t.sortBy(e):null,m:e}}),this.renderModels()}),_addModel:function(e){if(this.filterModel(e)){if(!this._d.listCache.length)return this.resetCollection();var t=this._d,i=this.sortBy(e),n={s:i,m:e},s=l.sortedIndex(t.listCache,n,"s");this.sortBy.reverse&&(s=t.listCache.length-s),t.listCache[s]&&t.listCache[s].m.cid===e.cid||(this.options.sparse&&s<this.getRenderOffset()&&(this.sparse.offset++,console.log("Adjusting offset to",this.sparse.offset)),t.listCache.splice(s,0,n),this.renderModels())}},_removeModel:function(e,t,i){var n=this.getView(e),s=this._d;this.options.sparse&&i.index<this.getRenderOffset()&&this.sparse.offset--,s.listCache=l(s.listCache).reject(function(t){return t.m.cid===e.cid}),n&&(n.detach(),s.renderedViews=l(s.renderedViews).without(n)),0===s.listCache.length&&this.resetCollection(),this.changed()},renderModels:r(function(){var e=this,t=this._d,i=this.getRenderOffset(),n=t.listCache;return this.renderTimerID&&(clearTimeout(this.renderTimerID),this.renderTimerID=null),this.isLoading()?(t.loadingSpinnerShown=!0,void this.renderLoading()):t.loadingSpinnerShown?(t.loadingSpinnerShown=!1,this.tableLoadingSpinner&&(this.tableLoadingSpinner.remove(),this.tableLoadingSpinner=null),void(this.renderTimerID=this.setTimeout(this.renderModels,this.options.renderThrottle))):0===t.listCache.length?void this.showNoData():(this.getRenderTarget().find(".empty_data_row").remove(),this.$el.removeClass("noData"),this.options.selectFirst&&this.selectFirst(),void 0!==this.options.multiSelect&&this.initialSelection&&this._d.listCache.length>0&&l(this._d.listCache).chain().filter(function(t){return e.initialSelection.indexOf(t.m.get("id")+"")>-1}).each(function(t){e.initialSelection=l.without(e.initialSelection,t.m.id),e.getStateModel(t.m).set("selected",!0)}),t.hasData=!0,this.options.sparse&&(console.log("Rendering views based on offset,",i),n=t.listCache.slice(i,i+this.options.sparseLimit),0===t.renderedViews.length&&e.options.sparse&&!e.sparse.rowHeight&&n.length>0&&(e.getView(n[0].m).renderTo(this.$el),t.renderedViews.push(e.getView(n[0].m)),this.updateSparseSizing(),t.renderedViews=[],e.getView(n[0].m)),this.resetSparsePosition(),this.$el.css({height:this.sparse.rowHeight*this._d.listCache.length})),void(n.length===t.renderedViews.length&&l.isEqual(t.renderedViews,l(n).map(function(t){return e.getView(t.m)}))||(this.renderHeader(),0===t.renderedViews.length?this.chunkRender(n,!0):this.chunkRender(n,!1))))}),chunkRenderID:0,chunkRender:function(e,t){var i,n,s=this,r=this._d,o=this.chunkRenderID,c=[],h=this.getRenderTarget(),d=0,u=this.options.renderLimit;for(this.chunkRenderID=this.chunkRenderID+1,r.renderID=o,r.isRendering=!0,this.clearTimeout(r.chunkRenderTimerID),s.options.sparse&&console.log("Rendering",e.length),i=0,n=Math.ceil(e.length/u);n>i;++i)c.push(e.slice(i*u,(i+1)*u));s.options.sparse&&console.log("and doing it in",c.length,"chunks"),i=0,a.eachSeries(c,function(i,n){return s.isRemoved||r.renderID!==o?(console.log("Canceling stale render",o),s.clearTimeout(r.chunkRenderTimerID),n("Render canceled")):l(i).all(function(e){return s.collection.contains(e.m)})?(s.detachDOM(),s.removeFooter(),l(i).chain().filter(function(e){return e.v=s.getView(e.m),(!e.v||e.v.isRemoved)&&s.resetCollection(),e.v}).each(function(i){var n=i.v,o=i.s;i.m;t?(r.renderedViews.push(n),n.detach(),n.$el.appendTo(h)):!function(){if(r.renderedViews.length<=d)return t=!0,n.$el.appendTo(h),void r.renderedViews.push(n);for(;r.renderedViews.length>d&&!l(e).any(function(e){return e.m.cid===r.renderedViews[d].model.cid});)s.options.sharedView?r.renderedViews.splice(d,1)[0].detach():r.renderedViews.splice(d,1)[0].remove();return r.renderedViews.length<=d?(t=!0,n.$el.appendTo(h),void r.renderedViews.push(n)):r.renderedViews[d].cid===n.cid?void(0===d?r.renderedViews[d].$el.prependTo(h):r.renderedViews[d].$el.insertAfter(r.renderedViews[d-1].lastElement())):(s.sortBy.reverse?s.sortBy(r.renderedViews[d].model)>o:s.sortBy(r.renderedViews[d].model)<o,!r.renderedViews[d].$el.closest(s.$el).length,n.detach(),n.$el.insertBefore(r.renderedViews[d].$el),void r.renderedViews.splice(d,0,n))}(),n.render(),d++}),s.onViewsChanged(),s.attachDOM(),s.renderFooter(),void(s.options.sync?n():r.chunkRenderTimerID=s.setTimeout(n,s.options.renderThrottle))):(console.log("Canceling bad render data",o),s.clearTimeout(r.chunkRenderTimerID),n("Render canceled"))},function(e){if(!s.isRemoved){if(r.renderID!==o)return void(s.options.sparse&&console.log("Completing canceled render...",d));r.isRendering=!1,s.removeFooter(),s.renderFooter(),console.log("Finished chunk rendering",d,i),s.changed()}})},removeFooter:function(){var e=this._d.renderedViews,t=e.length?e[e.length-1]:null;return this.tableLoadingSpinner&&!this._d.loadingSpinnerShown&&(this.tableLoadingSpinner.remove(),this.tableLoadingSpinner=null),t?(t.$el.next().remove(),void t.render()):(this.getRenderTarget().empty(),void this.renderHeader())},resetViews:function(){console.error("resetViews is depreciated, consider using a more intelligent method")},resort:function(){var e=this,t=this._d;t.listCache=l(t.listCache).sortBy(function(t){return t.s=e.sortBy(t.m),t.s}),e.sortBy.reverse&&t.listCache.reverse(),t.renderedViews=[],this.getRenderTarget().empty(),this.renderModels()},refilter:function(){this.resetCollection()},filterModel:function(e){return this.filterBy(e.toJSON(),e)},changed:function(){var e=this;this.changedQueued||(this.changedQueued=!0,this.setTimeout(function(){e.isRemoved||(e.changedQueued=!1,e.trigger("changed"),e.onChange(),e.checkRenderComplete())}))},onChange:function(){},sortBy:function(e){return this.collection.indexOf(e)},filterBy:function(e){var t=this,i=!0;if(this.options.searchEnabled){var n=c(this.options.searchInputSelector).val(),s=n?n.toLowerCase().split(" "):null,r=!1;r=null===s?!0:l.all(s,function(i){return l.any(l.filter(t.collection.fieldMetadata,function(e){return"function"==typeof e.getFilterData}),function(t,n){var s="function"==typeof t.getFilterData?t.getFilterData(e):e[n];s&&s.value&&(s=s.value);var r=s&&-1!==s.toString().toLowerCase().indexOf(i);return r})}),i=r}return"1"!==e.deleted&&i},renderHeader:function(){},renderFooter:function(){(this._d.isRendering||this.isLoading())&&this.renderLoading()},getOrder:function(){var e=[];return l.each(this.$(this.options.dragOrderingSelector),function(t){e.push(c(t).data("modelId"))}),e.join(",")},orderChanged:function(){this.trigger("order_changed",this.getOrder())},generateSparseRenderTarget:function(){var e,t=this.sparse;return t.holder?t.holder.appendTo(this.$el):t.holder=c("<"+this.options.sparseTagName+" />",{"class":"list_view_slider "+this.options.sparseClassName,css:{width:"100%",height:"10000px",position:"relative",display:"block"}}).appendTo(this.$el),e=s(t.holder.get(0)),t.holder.css({height:"",display:""}),e?(e=c(e),this.setupScrollParent(e),this.updateSparseSizing(),t.holder):t.holder},handleScroll:r(function(){if(this.sparse.rowHeight||this.updateSparseSizing(),this.sparse.rowHeight){var e,t,i=this._d,n=this.sparse,s=this.getRenderOffset(),r=n.scrollParent.get(0),o=r.scrollTop-n.scrollHeightOffset,a=n.rowHeight*s,c=this.options.sparseLimit-~~(r.offsetHeight/n.rowHeight);o-=a,o&&(s>0&&0>o?n.offset=s+o/n.rowHeight-c:o>n.rowHeight*c&&(n.offset=s+o/n.rowHeight),n.offset!==s&&(n.offset=~~Math.max(0,n.offset),this.collection.metadata?n.offset=Math.min(parseInt(this.collection.metadata.total)-this.options.sparseLimit,n.offset):n.offset=Math.min(parseInt(this.collection.length)-this.options.sparseLimit,n.offset)),n.offset!==s&&(e=n.offset-s,e>this.options.sparseLimit||0-e>this.options.sparseLimit?(i.renderedViews=[],this.getRenderTarget().empty()):(t=i.renderedViews.splice(e,this.options.sparseLimit-e),e>0&&!function(e){t=i.renderedViews,i.renderedViews=e}(t),this.resetSparsePosition(),l(t).each(function(e){e.detach()})),console.log("Changing the offset to",n.offset),console.log(o,n.rowHeight),this.renderModels()))}}),resetSparsePosition:function(){this.getRenderTarget().css({top:this.sparse.offset*this.sparse.rowHeight})},setupScrollParent:function(e){var t=this,i=this.sparse;i.scrollParent&&i.scrollParent.off("scroll.sparse"+t.cid),i.scrollParent=e,i.scrollParentListener=i.scrollParent,e&&e.length&&("BODY"===i.scrollParent.get(0).tagName&&(i.scrollParentListener=c(window)),i.scrollParentListener.on("scroll.sparse"+this.cid,function(){return t.isRemoved?void i.scrollParentListener.off("scroll.sparse"+t.cid):void t.handleScroll()}))},updateSparseSizing:function(){this.options.sparse&&(this.sparse.scrollParent&&this.sparse.scrollParent.length||(this.generateSparseRenderTarget(),this.sparse.scrollParent))&&0!==this._d.renderedViews.length&&(this.sparse.rowHeight||(this.sparse.rowHeight=this._d.renderedViews[0].$el.height()),this.$el.css({height:this.sparse.rowHeight*this._d.listCache.length}),this.sparse.scrollParent&&!this.sparse.scrollHeightOffset&&(this.sparse.holder.css({top:"auto"}),this.sparse.scrollHeightOffset=this.sparse.holder.offset().top-(this.sparse.scrollParent.offset()?this.sparse.scrollParent.offset().top:0)))},addLoadingPromise:function(e){var t=this,i=!this.isLoading();return!e||!e.done,this.loadingPromise=c.when(e,this.loadingPromise),this.loadingPromise.done(function(){t._resetCollection()}),this.readyAfter(this.loadingPromise),i&&this.renderModels(),this.loadingPromise},checkRenderComplete:function(){return this.isRemoved||this._d.isRendering||!this._d.hasData?!1:this._super("checkRenderComplete",arguments)?(this.stopListening(this,"change",this.checkRenderComplete),!0):!1},setLoadingPromise:function(e){},isLoading:function(){return 0===this.collection.length&&"resolved"!==this.loadingPromise.state()},renderLoading:function(){this.options.showLoadingAnimation&&this.tableLoadingSpinner&&this.tableLoadingSpinner.renderTo(this.$el)},showNoData:function(e){this.getRenderTarget().empty(),this.options.hideIfEmpty||(this.$el.addClass("noData"),this.renderHeader(),this.renderEmpty(e),this.renderFooter())},renderEmpty:function(e){if("tbody"===this.tagName||"table"===this.tagName){var t,i=this.collection.model;i.hasOwnProperty("noun")?t=i.noun:this.options.emptyImageType||(e="No Data"),this.options.emptyTableText&&(e=this.options.emptyTableText),this.getRenderTarget().append(['<tr class="no-click no-bg no-border empty_data_row">','<td class="empty_data_cell" colspan="99999">','<div class="empty_table_holder">','<div class="empty_table_image '+(this.options.emptyImageType||t)+'"></div>',"</div>","</td>","</tr>"].join(""))}else"div"===this.tagName?-1!==this.className.indexOf("isotope_list_view")&&(this.getRenderTarget().append(['<div class="empty_isotope_image '+(this.options.emptyImageType||t)+'"></div>'].join("")),this.getRenderTarget().height("340px")):"ul"===this.tagName&&(this.options.emptyImageType?this.getRenderTarget().append(['<div class="empty_list_image '+(this.options.emptyImageType||t)+'"></div>'].join("")):this.getRenderTarget().append([].join("")))},indexOf:function(e){var t=this._d,e=this.collection.get(e.id?e.id:e),i=this.sortBy(e),n={s:i,m:e};return l.sortedIndex(t.listCache,n,"s")},getRenderOffset:function(){return this.sparse.offset},getRenderTarget:function(){if(this.options.sparse){if(this.sparse.holder)return this.sparse.holder.parent().get(0)!==this.el&&this.sparse.holder.appendTo(this.$el),this.sparse.holder;if(this.$el.parent().length||this.placeHolder&&this.placeHolder.parent().length)return this.generateSparseRenderTarget()}return this.$el},getView:function(e){var t=this._d.viewCache[e.cid];return t&&!t.isRemoved?t:this.collection.contains(e)||(e=this.collection.get(e.id))?this.options.sharedView&&e.___list_view_shared_views[this.options.sharedView]?e.___list_view_shared_views[this.options.sharedView]:(t=new this.options.viewClass(c.extend(!0,{},this.options.viewClassOptions,{parent:this.options.sharedView?this.options.parent||this:this,model:e,collection:this.collection})),t.collection=this.collection,this._d.viewCache[e.cid]=t,this.options.sharedView&&(e.___list_view_shared_views[this.options.sharedView]=t,this.listenToOnce(t,"destroyed",function(){})),this.stopListening(this.getStateModel(e)),this.listenTo(this.getStateModel(e),"change:selected",this.selectedChanged),t):null},getStateModel:function(e){var t=this.options.sharedView?this.options.sharedView:this.cid;return"string"==typeof e||"number"==typeof e?e=this.collection.get(e):!e.toJSON&&e.id&&(e=this.collection.get(e.id)),e?(e.__list_view_state_models||(e.__list_view_state_models={}),
e.__list_view_state_models[t]||(e.__list_view_state_models[t]=new o.Model({selected:!1})),e.__list_view_state_models[t]):null},selectedChanged:r(function(e){e instanceof o.Model&&this.options.multiSelect===!1&&this.getStateModel(e).get("selected")&&this.unselectAll(e.id),this.trigger("selected_changed",e),this.$el.trigger("selected_changed",e)}),selectFirst:function(){var e=this.getSelected(),t=this._d.listCache;t.length&&(0===e.length?e=null:e.length&&(e=e[0]),e&&!l.any(t,function(t){return t.m.cid===e.cid})&&(e=null),e||this.selectByID(t[0].m.id))},selectAll:function(e){var t=this,i=!1;return i=e.target?c(e.target).is(":checked"):!!e,l(this._d.listCache).each(function(e){t.getStateModel(e.m).set({selected:i})}),!0},getSelected:function(){if(this.isRemoved)return[];var e=this;return this.collection.chain().filter(function(t){return e.getStateModel(t).attributes.selected}).value()},isSelected:function(e){return this.getStateModel(e).get("selected")},getSelectedModels:function(){return this.collection.filter(this.isSelected,this)},selectByID:function(e){var t=this.collection.get(e);if(t)return this.options.multiSelect||this.unselectAll(e),this.getStateModel(t).set({selected:!0}),this.stateModel&&this.stateModel.set({selectedRow:t}),!0},unselectAll:function(e){var t=this;this.collection.each(function(i){i.id==e||l(e).contains(i.id)||t.getStateModel(i).set({selected:!1})})},redelegateEvents:function(){this._super("redelegateEvents",arguments),l(this._d.renderedViews).each(function(e){e.redelegateEvents()})},remove:function(){this.sparse.scrollParent&&this.sparse.scrollParent.off("scroll.sparse"+this.cid),this._super("remove",arguments)}}),t.exports=o.ListView},{"./discus":4,"./model":7,"./view":14,async:1,jquery:"juYr6o",underscore:"h15NQi"}],6:[function(e,t,i){e("./discus"),e("./super"),e("./object"),e("./model"),e("./collection"),e("./view"),e("./screen"),e("./list_view"),e("./table_view"),t.exports=e("./discus")},{"./collection":3,"./discus":4,"./list_view":5,"./model":7,"./object":8,"./screen":9,"./super":10,"./table_view":13,"./view":14}],7:[function(e,t,i){function n(e,t,i){1==e.length?t[e[0]]=i:n(e.slice(1,e.length),t[e[0]],i)}var s=e("./discus"),r=e("./super"),o=e("backbone");s.Model=function(){o.Model.apply(this,arguments),this.discusInitialize.apply(this,arguments)},s.Model.prototype=o.Model.prototype,s.Model.extend=o.Model.extend,s.Model=s.Model.extend({_super:r,discusInitialize:function(e){this.___list_view_shared_views={},e&&e.parent&&console.error("Do not give models parents!!")},set:function(e){return e.toJSON||e.toArray,o.Model.prototype.set.apply(this,arguments)},setSubProp:function(e,t,i){var s=i&&i.separator||".",r=e.split(s),o=this.get(r[0]);n(r.slice(1,r.length),o,t),(void 0===i||i&&void 0!==i.silent&&i.silent===!1||i&&void 0===i.silent)&&this.trigger("change:"+r[0],this)},getSubProp:function(e,t){var i=t&&t.separator||".",n=e.split(i),s=this.get(n[0]);return n.slice(1,n.length).reduce(function(e,t){return e[t]},s)},fetch:function(){var e=o.Model.prototype.fetch.apply(this,arguments);return this.promise=e.promise,this.trigger("fetch",e.promise()),e},save:function(){var e=o.Model.prototype.save.apply(this,arguments);return this.promise=e.promise,this.trigger("save",e.promise()),e},getMetadata:function(e){return this.metadata[e]},value:function(e){var t=this.getMetadata(e);return t&&"function"==typeof t.value?t.value.apply(this,[e]):this.get(e)},displayValue:function(e){var t=this.getMetadata(e);return t&&"function"==typeof t.displayValue?t.displayValue.apply(this,[e]):this.value(e)},filterValue:function(e){var t=this.getMetadata(e);return t&&"function"==typeof t.getFilterData?t.getFilterData.apply(this,[e]):this.value(e)},metadata:{title:{name:"Title",type:"string"}}}),t.exports=s.Model},{"./discus":4,"./super":10,backbone:"205lIr"}],8:[function(e,t,i){var n=e("underscore"),s=e("./discus"),r=e("./super");s.Object=function(){var e,t=this;this.cid=n.uniqueId("class"),e=arguments,t.init=function(){var i=t.initialize.apply(t,e);return function(){return i}}()},n.extend(s.Object.prototype,s.Events,{initialize:function(){return this},_super:r}),s.Object.extend=s.Model.extend,t.exports=s.Object},{"./discus":4,"./super":10,underscore:"h15NQi"}],9:[function(e,t,i){var n=e("./discus");e("./view"),n.Screen=n.View.extend({screenStateModel:function(){return this.stateModel}})},{"./discus":4,"./view":14}],10:[function(e,t,i){function n(e,t){for(var i=t;i[e]===t[e];)if(i=i.constructor.__super__,!i)throw new Error("Class has no super method for",e,". Remove the _super call to the non-existent method");return i}function s(e,t){void 0===this._superCallObjects&&(this._superCallObjects={});var i,s=this._superCallObjects[e],r=s||this,o=n(e,r);this._superCallObjects[e]=o;try{i=o[e].apply(this,t||[])}finally{s?this._superCallObjects[e]=s:delete this._superCallObjects[e]}return i}var r=e("./discus");e("underscore").each(["Collection","Router"],function(e){r[e].prototype._super=s}),t.exports=s},{"./discus":4,underscore:"h15NQi"}],11:[function(e,t,i){var n=e("underscore"),s=e("./discus");s.TableEntry=s.View.extend({tagName:"tr",initialize:function(){this._super("initialize",arguments),this.table=this.options.parent},render:function(){var e=this;this.$el.empty(),n(this.table.stateModel.get("columns")).each(function(t){e.renderColumn(t,e.model.displayValue(t))}),this.redelegateEvents()},renderColumn:function(e,t){this.$el.append("<td>"+t+"</td>")}}),t.exports=s.TableEntry},{"./discus":4,underscore:"h15NQi"}],12:[function(e,t,i){var n=e("./discus"),s=e("jquery"),r=e("underscore");n.TableHeader=n.View.extend({defaults:function(){return{flaoting:!1}},tagName:"thead",stateModelEvents:{table:{"change:columns":"render"}},initialize:function(){this.table=this.options.parent,this.stateModel=this.getSharedStateModel("table")},render:function(){var e=this.stateModel.get("columns"),t=s("<tr />");this.$el.empty(),this.$el.append(t),r(e).each(function(e){t.append("<th>"+e+"</th>")})}}),t.exports=n.TableHeader},{"./discus":4,jquery:"juYr6o",underscore:"h15NQi"}],13:[function(e,t,i){var n=e("./discus"),s=e("./list_view"),r=e("./table_entry"),o=e("./table_header"),a=e("jquery"),l=e("underscore");n.TableView=s.extend({defaults:function(){var e=this._super("defaults",arguments);return a.extend(e,{sparse:!0,renderLimit:12,renderThrottle:150,sparseTagName:"tbody",sparseClassName:"tableView",sparseLimit:100,viewClass:r,headerViewClass:o,table:!0,hover:!1,bordered:!1,striped:!1}),e},tagName:"table",stateModelEvents:{"change:columns":"resetCollection"},initialize:function(){if(!this.options.columns||!l.isArray(this.options.columns))throw new Error("You must pass columns in to Talbe View");this.options.table&&(this.className+=" table"),this.options.hover&&(this.className+=" table-hover"),this.options.bordered&&(this.className+=" table-bordered"),this.options.striped&&(this.className+=" table-striped"),this._super("initialize",arguments),this.$el.attr("class",this.className),this.createSharedStateModel("table",this.stateModel),this.stateModel.set({columns:this.options.columns}),this.tableHeader=new this.options.headerViewClass({parent:this})},renderHeader:function(){this.tableHeader.$el.prependTo(this.$el),this.tableHeader.render()}}),t.exports=n.TableView},{"./discus":4,"./list_view":5,"./table_entry":11,"./table_header":12,jquery:"juYr6o",underscore:"h15NQi"}],14:[function(e,t,i){var n=e("./discus"),s=e("./super"),r=e("underscore"),o=e("backbone"),a=e("jquery"),l=n.VERSION_ARRAY[0]>=1&&n.VERSION_ARRAY[1]>=1,c={};n.viewByCID=function(e){return c[e]||null},n.View=function(e){l&&(this.options=e),o.View.apply(this,arguments),this.$el.attr({"data-cid":this.cid}),this.discusInitialize(),c[this.cid]=this},n.View.prototype=o.View.prototype,n.View.extend=o.View.extend,n.View=n.View.extend({_super:s,__lsModelCache:{},_configure:function(e){l||this._super("_configure",arguments),this.options=e,r.defaults(this.options,r.isFunction(this.defaults)?this.defaults():this.defaults),this.__children={},this._checkRenderComplete=this.checkRenderComplete,this.checkRenderComplete=r.debounce(this.checkRenderComplete,10)},defaults:function(){return{}},discusInitialize:function(){if(this.options.parent){if(this.options.parent===window)return void console.error("Passed in parent: this when you meant to do parent: self");this.setParent(this.options.parent)}else this.options.renderTo&&console.error("renderTo does nothing without a parent!");this.model&&(r.isFunction(this.model.promise)&&this.readyAfter(this.model.promise()),this.listenTo(this.model,"fetch",this.readyAfter)),this.collection&&(r.isFunction(this.collection.promise)&&this.readyAfter(this.collection.promise()),this.listenTo(this.collection,"fetch fetchAll",this.readyAfter)),this.modelEvents&&this.model&&this._bindEventsToModel(this.model,this.modelEvents),this.collectionEvents&&this.collection&&this._bindEventsToModel(this.collection,this.collectionEvents),this._setupStateModels()},_setupStateModels:function(){var e=this,t=this.stateModel||this.getSharedStateModel();this.stateModelEvents&&r(this.stateModelEvents).chain().map(function(i,n){return"object"==typeof i?r(i).map(function(t,i){return{model:e.getSharedStateModel(n),handler:t,eventName:i}}):{model:t,handler:i,eventName:n}}).flatten().groupBy(function(e){return e.model.cid}).each(function(t){var i=r(t).first().model,n=r(t).chain().map(function(e){return[e.eventName,e.handler]}).object().value();e._bindEventsToModel(i,n)})},_bindEventsToModel:function(e,t){var i=this;return r(t).each(function(t,n){if("string"==typeof t&&(t=i[t]),!r.isFunction(t))throw new Error("Could not find handler for event, "+n);i.listenTo(e,n,t)}),this},screenStateModel:function(){return this.hasParent()?this.getParent().screenStateModel():this.stateModel},createSharedStateModel:function(e,t){return t instanceof o.Model||(t="object"==typeof t?new o.Model(t):new o.Model),this.__sharedStateModels?this.__sharedStateModels[e]&&console.warn("Overwriting shared state model %s with another Backbone Model",e):this.__sharedStateModels={},this.__sharedStateModels[e]=t,t},getSharedStateModel:function(e){return"SCREEN"===e?this.screenStateModel():this.__sharedStateModels&&this.__sharedStateModels[e]?this.__sharedStateModels[e]:this.getParent()?this.getParent().getSharedStateModel(e):this.createSharedStateModel(e)},addElement:function(e){var t=this,i=a(e);if(i.length>1)i.each(function(){t.addElement(this)});else if(0===i.length)throw new Error("Invalid element!");if(this.$el.closest(i).length)throw new Error("Element is a child of this view. This is only for unrelated elements");if(i.closest(this.$el).length)throw new Error("Element is an ancestor of this view! Reconsider how you're using this view.");e=i.get(0),this._trackedElements||(this._trackedElements=[]),r(this._trackedElements).each(function(e){var t=a(e);if(t.closest(i).length)throw new Error("Element is a child of another tracked element. This will cause problems.");if(i.closest(t).length)throw new Error("Element is an ancestor of another tracked element. This will cause problems.")}),this._trackedElements.push(e)},lastElement:function(){var e=this.$el;return r(this._trackedElements).each(function(t){var i=a(t);e.nextAll().is(i)&&(e=i)}),e},clearTimeout:function(e){return this.__timerIDS&&(this.__timerIDS=r(this.__timerIDS).without(e)),clearTimeout(e)},setTimeout:function(e,t,i){var n,s=this;return n=setTimeout(function(){this.__timerIDS=r(this.__timerIDS).without(n),e.apply(s,i)}),this.__timerIDS?this.__timerIDS.push(n):this.__timerIDS=[n],n},setInterval:function(e,t,i){var n,s=this;return n=setInterval(function(){this.__timerIDS=r(this.__timerIDS).without(n),e.apply(s,i)}),this.__timerIDS?this.__timerIDS.push(n):this.__timerIDS=[n],n},addChild:function(e){return this.__children||(this.__children={}),e?(this.__children[e.cid]=e,this.listenTo(e,"destroyed",function(){this.removeChild(e)}),void this.listenTo(e,"renderComplete",this.checkRenderComplete)):void console.warn("Tried to add a non-existent child")},removeChild:function(e){return e?(delete this.__children[e.cid],this.stopListening(e),void(e.getParent().cid===this.cid&&e.setParent())):void console.warn("Tried to remove non-existent child")},hasParent:function(){return!!this.getParent()},getParent:function(){return this.__current_parent||this.options.parent},setParent:function(e){if(this.__current_parent){if(e&&this.__current_parent.cid===e.cid)return;this.stopListening(this.__current_parent,"destroyed",this.remove),this.stopListening(this.__current_parent,"rendered")}this.__current_parent=e,e&&(this.listenTo(this.__current_parent,"destroyed",this.remove),e.addChild(this),this.options.renderTo&&this.listenTo(this.__current_parent,"rendered",function(){this.renderTo(this.__current_parent.$(this.options.renderTo))}))},checkRenderComplete:function(){return this.isRemoved?!1:this.isRenderComplete?!0:(!this.__readyPromise||this.__readyPromise.isResolved&&this.__readyPromise.isResolved()||this.__readyPromise.state&&"resolved"==this.__readyPromise.state())&&r.all(this.__children,function(e){return e._checkRenderComplete()})?(this.isRenderComplete=!0,this.trigger("renderComplete"),this.onRenderComplete(),!0):!1},onRenderComplete:function(){},readyAfter:function(e){var t=this;this.__readyPromise?this.__readyPromise=e:this.__readyPromise=a.when(this.__readyPromise,e),e.done(function(){t.checkRenderComplete()})},getTemplateData:function(){var e,t={};return this.model&&a.extend(t,this.model.toJSON()),this.stateModel&&(e=this.stateModel.toJSON(),a.extend(t,{stateModel:e})),t},onBeforeRender:function(){},render:function(){var e,t;return this.$el.attr({"data-cid":this.cid}),this.onBeforeRender(),e=this.getTemplateData(),this._templateData=e,this.stateModel&&(t=this.stateModel.toJSON()),t&&t.state&&this[t.state+"_template"]?this.$el.html(this[t.state+"_template"](e)):this.template&&this.$el.html(this.template(e)),this.redelegateEvents(),this.trigger("rendered"),this.onRender(),this},onRender:function(){},renderTo:function(e){return this.$el.appendTo(e),this.render(),this},redelegateEvents:function(){return this.undelegateEvents(),this.delegateEvents(),this},detach:function(){this.isRemoved||(this.$el.detach(),r(this._trackedElements).each(function(e){a(e).detach()}))},remove:function(){var e=this,t=(new Error).stack,i=e.cid;return this.isRemoved?void console.warn("This view was removed twice!",this.render.stack):(this._super("remove",arguments),this.$el.remove(),a(document).off("."+i),a(window).off("."+i),r(this.__timerIDS).each(clearTimeout),delete c[i],this.undelegateEvents(),this.stopListening(),this.isRemoved=!0,this.trigger("destroyed"),delete this.__current_parent,a.each(this,function(t){e.hasOwnProperty(t)&&"_superCallObjects"!==t&&"cid"!==t&&(n.isDev&&e[t]&&e[t]instanceof n.View&&!e[t].isRemoved&&"function"==typeof e[t].remove&&console.warn("[GC] Should this view",i,"have removed its sub-view",t,"?"),e[t]=null,delete e[t])}),this.model&&(this.model=null),this.collection&&(this.collection=null),this.isRemoved=!0,this.render=function(){console.log(t)},void(this.render.stack=t))},preventDefault:function(e){return e?("function"==typeof e.preventDefault&&e.preventDefault(),"function"==typeof e.stopPropagation&&e.stopPropagation(),!1):!1}}),l&&(n.View.prototype._ensureElement=function(){return this._configure(this.options||{}),o.View.prototype._ensureElement.apply(this,arguments)}),t.exports=n.View},{"./discus":4,"./super":10,backbone:"205lIr",jquery:"juYr6o",underscore:"h15NQi"}]},{},[6])(6)});